# 现象

最近做项目的时候遇到一个奇怪的问题，服务器将一个id传给app，app解析后拿到的id和服务器传过去的总是不同，或者大一些或者小一些。比如服务器传递的是190115096930816001，而app拿到的却是190115096930816000。

# 排查

起初是以为中间的某一个链路传错了数据，但是通过日志可以看出服务端各个链路的数据都是正确的。如果服务器这边的数据都是正确的，那问题应该是出在客户端，是否是客户端在使用的时候对id做了什么操作，客户端同学看了代码后也将这种猜测排除了，此时大家陷入了迷茫。

但是车到山前必有路 ~ 一个同学在将服务器传输的json贴到json工具的时候发现，对应的id被解析成了另一个数据。真相逐渐浮出了水面，问题似乎是出在了json的解析上，为了验证这个结论我们将之前的多个出问题的id分别进行json解析，发现得到的数据基本上都与之前的不同，连我们日常使用的jq都会得到错误的数据。这次的改动是将id的位数提高了3位，也就是从原来的15位id变成了18位id，会不会是json对于大整数的支持有问题呢？看样子我们得从json本身入手了。

# 原理

想了解json的原理，最权威的莫过于rfc协议了。找到rfc协议[https://tools.ietf.org/html/rfc7159#page-6](https://tools.ietf.org/html/rfc7159#page-6)